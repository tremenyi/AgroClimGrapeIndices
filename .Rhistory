time_rain_start <- Sys.time()
rain <- AgroClimGrapeIndices:::cell_extract_spatial_variant(src_rain_files, shp_spatial_transformed)
time_rain_end <- Sys.time()
# time_tmax_start <- Sys.time()
# tmax_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmax_files, target_domain, wine_region_polygons_target_cells)
# time_tmax_end <- Sys.time()
#
# time_tmin_start <- Sys.time()
# tmin_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmin_files, target_domain, wine_region_polygons_target_cells)
# time_tmin_end <- Sys.time()
#
# time_rain_start <- Sys.time()
# rain_by_cells <- extract_variable_from_files_by_cells(target_files = src_rain_files, target_domain, wine_region_polygons_target_cells)
# time_rain_end <- Sys.time()
#
time_end <- Sys.time()
cat("tmax time: ", time_tmax_end - time_tmax_start, "\n")
cat("tmin time: ", time_tmin_end - time_tmin_start, "\n")
cat("rain time: ", time_rain_end - time_rain_start, "\n")
cat("Total time:", time_end - time_start, "\n")
library(AgroClimGrapeIndices)
time_start <- Sys.time()
time_tmax_start <- Sys.time()
tmax <- AgroClimGrapeIndices:::cell_extract_spatial_variant(src_tmax_files, shp_spatial_transformed)
time_tmax_end <- Sys.time()
time_tmin_start <- Sys.time()
tmin <- AgroClimGrapeIndices:::cell_extract_spatial_variant(src_tmin_files, shp_spatial_transformed)
time_tmin_end <- Sys.time()
time_rain_start <- Sys.time()
rain <- AgroClimGrapeIndices:::cell_extract_spatial_variant(src_rain_files, shp_spatial_transformed)
time_rain_end <- Sys.time()
# time_tmax_start <- Sys.time()
# tmax_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmax_files, target_domain, wine_region_polygons_target_cells)
# time_tmax_end <- Sys.time()
#
# time_tmin_start <- Sys.time()
# tmin_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmin_files, target_domain, wine_region_polygons_target_cells)
# time_tmin_end <- Sys.time()
#
# time_rain_start <- Sys.time()
# rain_by_cells <- extract_variable_from_files_by_cells(target_files = src_rain_files, target_domain, wine_region_polygons_target_cells)
# time_rain_end <- Sys.time()
#
time_end <- Sys.time()
cat("tmax time: ", time_tmax_end - time_tmax_start, "\n")
cat("tmin time: ", time_tmin_end - time_tmin_start, "\n")
cat("rain time: ", time_rain_end - time_rain_start, "\n")
cat("Total time:", time_end - time_start, "\n")
unique(
unlist(
lapply(wine_region_polygon_cells_per_domain_lookup, function(x) { x[["matching_cells"]][[target_domain_key]] })
)
)
target_cell_indices <- get_target_cell_indices_for_domain(target_domain, wine_region_polygon_cells_per_domain_lookup)
target_cell_indices <- get_target_cell_indices_for_domain(target_domain, wine_region_polygons_target_cells)
time_start <- Sys.time()
time_tmax_start <- Sys.time()
tmax <- AgroClimGrapeIndices:::cell_extract_spatial_variant(src_tmax_files, wine_region_polygons_target_cells)
time_tmax_end <- Sys.time()
time_tmin_start <- Sys.time()
tmin <- AgroClimGrapeIndices:::cell_extract_spatial_variant(src_tmin_files, wine_region_polygons_target_cells)
time_tmin_end <- Sys.time()
time_rain_start <- Sys.time()
rain <- AgroClimGrapeIndices:::cell_extract_spatial_variant(src_rain_files, wine_region_polygons_target_cells)
time_rain_end <- Sys.time()
# time_tmax_start <- Sys.time()
# tmax_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmax_files, target_domain, wine_region_polygons_target_cells)
# time_tmax_end <- Sys.time()
#
# time_tmin_start <- Sys.time()
# tmin_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmin_files, target_domain, wine_region_polygons_target_cells)
# time_tmin_end <- Sys.time()
#
# time_rain_start <- Sys.time()
# rain_by_cells <- extract_variable_from_files_by_cells(target_files = src_rain_files, target_domain, wine_region_polygons_target_cells)
# time_rain_end <- Sys.time()
#
time_end <- Sys.time()
cat("tmax time: ", time_tmax_end - time_tmax_start, "\n")
cat("tmin time: ", time_tmin_end - time_tmin_start, "\n")
cat("rain time: ", time_rain_end - time_rain_start, "\n")
cat("Total time:", time_end - time_start, "\n")
time_start <- Sys.time()
time_tmax_start <- Sys.time()
tmax <- AgroClimGrapeIndices:::cell_extract_spatial_variant(src_tmax_files, wine_region_polygons_target_cells)
time_tmax_end <- Sys.time()
time_tmin_start <- Sys.time()
tmin <- AgroClimGrapeIndices:::cell_extract_spatial_variant(src_tmin_files, wine_region_polygons_target_cells)
time_tmin_end <- Sys.time()
time_rain_start <- Sys.time()
rain <- AgroClimGrapeIndices:::cell_extract_spatial_variant(src_rain_files, wine_region_polygons_target_cells)
time_rain_end <- Sys.time()
# time_tmax_start <- Sys.time()
# tmax_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmax_files, target_domain, wine_region_polygons_target_cells)
# time_tmax_end <- Sys.time()
#
# time_tmin_start <- Sys.time()
# tmin_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmin_files, target_domain, wine_region_polygons_target_cells)
# time_tmin_end <- Sys.time()
#
# time_rain_start <- Sys.time()
# rain_by_cells <- extract_variable_from_files_by_cells(target_files = src_rain_files, target_domain, wine_region_polygons_target_cells)
# time_rain_end <- Sys.time()
#
time_end <- Sys.time()
cat("tmax time: ", time_tmax_end - time_tmax_start, "\n")
cat("tmin time: ", time_tmin_end - time_tmin_start, "\n")
cat("rain time: ", time_rain_end - time_rain_start, "\n")
cat("Total time:", time_end - time_start, "\n")
library(AgroClimGrapeIndices)
time_start <- Sys.time()
time_tmax_start <- Sys.time()
tmax <- AgroClimGrapeIndices:::cell_extract_spatial_variant(src_tmax_files, wine_region_polygons_target_cells)
time_tmax_end <- Sys.time()
time_tmin_start <- Sys.time()
tmin <- AgroClimGrapeIndices:::cell_extract_spatial_variant(src_tmin_files, wine_region_polygons_target_cells)
time_tmin_end <- Sys.time()
time_rain_start <- Sys.time()
rain <- AgroClimGrapeIndices:::cell_extract_spatial_variant(src_rain_files, wine_region_polygons_target_cells)
time_rain_end <- Sys.time()
# time_tmax_start <- Sys.time()
# tmax_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmax_files, target_domain, wine_region_polygons_target_cells)
# time_tmax_end <- Sys.time()
#
# time_tmin_start <- Sys.time()
# tmin_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmin_files, target_domain, wine_region_polygons_target_cells)
# time_tmin_end <- Sys.time()
#
# time_rain_start <- Sys.time()
# rain_by_cells <- extract_variable_from_files_by_cells(target_files = src_rain_files, target_domain, wine_region_polygons_target_cells)
# time_rain_end <- Sys.time()
#
time_end <- Sys.time()
cat("tmax time: ", time_tmax_end - time_tmax_start, "\n")
cat("tmin time: ", time_tmin_end - time_tmin_start, "\n")
cat("rain time: ", time_rain_end - time_rain_start, "\n")
cat("Total time:", time_end - time_start, "\n")
time_start <- Sys.time()
time_tmax_start <- Sys.time()
tmax <- cell_extract_spatial_file_list(src_tmax_files, shp_spatial_transformed)
time_tmax_end <- Sys.time()
time_tmin_start <- Sys.time()
tmin <- cell_extract_spatial_file_list(src_tmin_files, shp_spatial_transformed)
time_tmin_end <- Sys.time()
time_rain_start <- Sys.time()
rain <- cell_extract_spatial_file_list(src_rain_files, shp_spatial_transformed)
time_rain_end <- Sys.time()
# time_tmax_start <- Sys.time()
# tmax_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmax_files, target_domain, wine_region_polygons_target_cells)
# time_tmax_end <- Sys.time()
#
# time_tmin_start <- Sys.time()
# tmin_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmin_files, target_domain, wine_region_polygons_target_cells)
# time_tmin_end <- Sys.time()
#
# time_rain_start <- Sys.time()
# rain_by_cells <- extract_variable_from_files_by_cells(target_files = src_rain_files, target_domain, wine_region_polygons_target_cells)
# time_rain_end <- Sys.time()
#
time_end <- Sys.time()
cat("tmax time: ", time_tmax_end - time_tmax_start, "\n")
cat("tmin time: ", time_tmin_end - time_tmin_start, "\n")
cat("rain time: ", time_rain_end - time_rain_start, "\n")
cat("Total time:", time_end - time_start, "\n")
src_tmax_files <- dir(path = "/rdsi/public/CFA/BoM_daily_vars/tmax/", pattern = "*.nc", full.names = TRUE)
src_tmin_files <- dir(path = "/rdsi/public/CFA/BoM_daily_vars/tmin/", pattern = "*.nc", full.names = TRUE)
src_rain_files <- dir(path = "/rdsi/public/CFA/BoM_daily_vars/rain_recal/", pattern = "*.nc", full.names = TRUE)
time_start <- Sys.time()
#
# time_tmax_start <- Sys.time()
# tmax <- cell_extract_spatial_file_list(src_tmax_files, shp_spatial_transformed)
# time_tmax_end <- Sys.time()
# time_tmin_start <- Sys.time()
# tmin <- cell_extract_spatial_file_list(src_tmin_files, shp_spatial_transformed)
# time_tmin_end <- Sys.time()
# time_rain_start <- Sys.time()
# rain <- cell_extract_spatial_file_list(src_rain_files, shp_spatial_transformed)
# time_rain_end <- Sys.time()
# time_tmax_start <- Sys.time()
# tmax_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmax_files, target_domain, wine_region_polygons_target_cells)
# time_tmax_end <- Sys.time()
time_tmin_start <- Sys.time()
tmin_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmin_files, target_domain, wine_region_polygons_target_cells)
time_tmin_end <- Sys.time()
time_rain_start <- Sys.time()
rain_by_cells <- extract_variable_from_files_by_cells(target_files = src_rain_files, target_domain, wine_region_polygons_target_cells)
time_rain_end <- Sys.time()
time_end <- Sys.time()
cat("tmax time: ", time_tmax_end - time_tmax_start, "\n")
cat("tmin time: ", time_tmin_end - time_tmin_start, "\n")
cat("rain time: ", time_rain_end - time_rain_start, "\n")
cat("Total time:", time_end - time_start, "\n")
save(rain_by_cells, file = '/mnt/drollins_workspace/data/bom_rain_by_cells.Rdata')
time_tmax_start <- Sys.time()
tmax_by_cells <- extract_variable_from_files_by_cells(target_files = src_tmax_files, target_domain, wine_region_polygons_target_cells)
time_tmax_end <- Sys.time()
src_rain_files <- dir(path = "/rdsi/public/CFA/BoM_daily_vars/rain_recal/", pattern = "*.nc", full.names = TRUE)
cat("tmax time: ", time_tmax_end - time_tmax_start, "\n")
cat("tmin time: ", time_tmin_end - time_tmin_start, "\n")
cat("rain time: ", time_rain_end - time_rain_start, "\n")
cat("Total time:", time_end - time_start, "\n")
save(tmax_by_cells, file = '/mnt/drollins_workspace/data/bom_tmax_by_cells.Rdata')
params <- c(base_budb = 3.5,
base_leaf = 7.1,
bracket_budb_leaf = 350,
bracket_leaf_pick = 1000,
DMT_threshold_pctile = 95,
climatology_start = 1962,
climatology_end = 1990,
min_duration = 3,
downy_mildew_threshold_temp = 10
)
rm(tmax)
rm(tmin)
rm(rain)
time_df_tas <- make_time_dataframe_from_nc_files(src_tmax_files)
wine_region_bom_tas_daily <- build_data_tbl(time_df_tas, tmax_by_cells, tmin_by_cells, rain_by_cells)
save(wine_region_bom_tas_daily, file = '/mnt/drollins_workspace/data/bom_daily_data_tbl_by_cells.Rdata')
head(wine_region_bom_tas_daily)
load('/mnt/drollins_workspace/data/bom_daily_data_tbl_by_cells.Rdata')
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list
variable = names(variable_list),
stringsAsFactors=FALSE)
model_list <- c("ERA")     # c("ERA", "ACCESS1-0")
domain_list <- c("50km")   # c("50km", "5km", "tas10km", "sea10km")
variables_list <- vector("list")
variables_list[["domain_50km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
variable = names(variable_list),
stringsAsFactors = FALSE)
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
variable = names(variables_list),
stringsAsFactors = FALSE)
View(target_inputs_table)
model_list <- c("ERA", "ACCESS1-0")
domain_list <- c("50km", "5km", "tas10km", "sea10km")
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
variable = names(variables_list),
stringsAsFactors = FALSE)
View(target_inputs_table)
variables_list <- vector("list")
variables_list[["domain_05km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_50km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_sea10km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_tas10km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
model_list <- c("ERA", "ACCESS1-0")
domain_list <- c("50km", "5km", "tas10km", "sea10km")
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
variable = names(variables_list),
stringsAsFactors = FALSE)
View(target_inputs_table)
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
variable = variables_list,
stringsAsFactors = FALSE)
View(target_inputs_table)
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
variable = variables_list[[sprintf("domain_%s", target_domain)]],
stringsAsFactors = FALSE)
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
variable = variables_list[[sprintf("domain_%s", domain)]],
stringsAsFactors = FALSE)
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
variable = variables_list[[sprintf("domain_%s", domain_list)]],
stringsAsFactors = FALSE)
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
stringsAsFactors = FALSE)
View(target_inputs_table)
sprintf("domain_%s", domain_list)
target_inputs_table
sprintf("domain_%s", names(variables_list))
sprintf("domain_%s",
names(variables_list)
sprintf("domain_%s", domain_list)
names(variables_list)
domain_list <- c("05km", "50km", "tas10km", "sea10km")
variables_list <- vector("list")
variables_list[["domain_05km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_50km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_sea10km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_tas10km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
names(variables_list)
sprintf("domain_%s", domain_list)
target_inputs_table %>% inner_join(variables_list, by = c(sprintf("domain_%s", domain), names(variables_list)))
# calc GDD for BoM data
library(raster)
library(RmarineHeatWaves)
library(plyr)
library(dplyr)
library(sf)
library(stringr)
library(future)
library(zoo)
library(ggplot2)
ColourBlindFriendlyPalette <- c("#000000", "#999999", "#0072B2", "#56B4E9", "#009E73", "#F0E442", "#E69F00", "#D55E00", "#CC79A7")
library(AgroClimGrapeIndices)
target_inputs_table %>% inner_join(variables_list, by = c(sprintf("domain_%s", domain), names(variables_list)))
domain_list <- c("domain_05km", "domain_50km", "domain_tas10km", "domain_sea10km")
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
stringsAsFactors = FALSE)
View(target_inputs_table)
target_inputs_table %>% inner_join(variables_list, by = c("domain", names(variables_list)))
#target climate model files
model_list <- c("ERA", "ACCESS1-0")
domain_list <- c("domain_05km", "domain_50km", "domain_tas10km", "domain_sea10km")
variables_list <- vector("list")
variables_list[["domain_05km"]] = c("tasmax_day", "tasmin_day")
variables_list[["domain_50km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_sea10km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_tas10km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
# use grid.expand
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
variable = variable_list,
stringsAsFactors = FALSE)
#target climate model files
model_list <- c("ERA", "ACCESS1-0")
domain_list <- c("domain_05km", "domain_50km", "domain_tas10km", "domain_sea10km")
variables_list <- vector("list")
variables_list[["domain_05km"]] = c("tasmax_day", "tasmin_day")
variables_list[["domain_50km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_sea10km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_tas10km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
# use grid.expand
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
variable = variables_list,
stringsAsFactors = FALSE)
View(target_inputs_table)
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
# variable = variables_list,
stringsAsFactors = FALSE)
View(variables_list)
as.data.frame(variables_list)
View(variables_list)
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
stringsAsFactors = FALSE)
View(target_inputs_table)
domain_list <- c("05km", "50km", "tas10km", "sea10km")
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
stringsAsFactors = FALSE)
View(target_inputs_table)
target_model <- model_list[1]
target_domain <- domain_list[1]
target_variable <- variables_list[[sprintf("domain_%s", target_domain)]][1]
target_path <- sprintf("%s/%s/%s", base_dir, target_model, target_domain)
base_dir <- "/rdsi/private/climatefutures"
target_path <- sprintf("%s/%s/%s", base_dir, target_model, target_domain)
domain_list <- c("5km", "50km", "tas10km", "sea10km")
target_path <- sprintf("%s/%s/%s", base_dir, target_model, target_domain)
target_domain <- domain_list[1]
target_path <- sprintf("%s/%s/%s", base_dir, target_model, target_domain)
target_files <- dir(path=target_path, pattern=target_variable, full.names = TRUE)
View(target_inputs_table)
target_variable <- variables_list[[sprintf("domain_%s", target_domain)]][1]
variables_list <- vector("list")
variables_list[["domain_05km"]] = c("tasmax_day", "tasmin_day")
variables_list[["domain_50km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_sea10km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_tas10km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list <- vector("list")
variables_list[["domain_5km"]] = c("tasmax_day", "tasmin_day")
variables_list[["domain_50km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_sea10km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_tas10km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
target_variable <- variables_list[[sprintf("domain_%s", target_domain)]][1]
variables_list
sprintf("domain_%s", target_domain)
variables_list[[sprintf("domain_%s", target_domain)]]
View(target_inputs_table)
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
variable = NA,
stringsAsFactors = FALSE)
View(target_inputs_table)
variables_list <- c("tasmax_day", "tasmin_day")
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
variable = variables_list,
stringsAsFactors = FALSE)
View(target_inputs_table)
model_list <- c("ERA")    # c("ERA", "ACCESS1-0")
domain_list <- c("50km")  # c("5km", "50km", "tas10km", "sea10km")
variables_list <- c("tasmax_day", "tasmin_day")
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
variable = variables_list,
stringsAsFactors = FALSE)
View(target_inputs_table)
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
variable = variables_list,
stringsAsFactors = FALSE)
target_input <- target_inputs_table[1]
View(target_input)
target_input <- target_inputs_table[1,]
target_model <- target_input$model
target_domain <- target_input$domain
target_variable <- target_input$variable
target_path <- sprintf("%s/%s/%s", base_dir, target_model, target_domain)
target_files <- dir(path=target_path, pattern=target_variable, full.names = TRUE)
extracted <- extract_variable_from_files_by_cells(target_files, target_domain, wine_region_polygons_target_cells)
load("/mnt/WineAustralia_working_files/data/wine_region_polygon_matching_indices_for_each_domain.RData")
extracted <- extract_variable_from_files_by_cells(target_files, target_domain, wine_region_polygons_target_cells)
target_input <- target_inputs_table[2,]
target_model <- target_input$model
target_domain <- target_input$domain
target_variable <- target_input$variable
target_path <- sprintf("%s/%s/%s", base_dir, target_model, target_domain)
target_files <- dir(path=target_path, pattern=target_variable, full.names = TRUE)
extracted <- extract_variable_from_files_by_cells(target_files, target_domain, wine_region_polygons_target_cells)
target_input <- target_inputs_table[2,]
target_model <- target_input$model
target_domain <- target_input$domain
target_variable <- target_input$variable
target_path <- sprintf("%s/%s/%s", base_dir, target_model, target_domain)
target_files <- dir(path=target_path, pattern=target_variable, full.names = TRUE)
extracted <- extract_variable_from_files_by_cells(target_files, target_domain, wine_region_polygons_target_cells)
model_list <- c("ERA", "ACCESS1-0")
domain_list <- c("5km", "50km", "tas10km", "sea10km")
variables_list <- vector("list")
variables_list[["domain_5km"]] = c("tasmax_day", "tasmin_day")
variables_list[["domain_50km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_sea10km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
variables_list[["domain_tas10km"]] = c("tasmax_day")   # c("tasmax_day", "tasmin_day")
View(variables_list)
View(target_inputs_table)
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
stringsAsFactors = FALSE)
View(target_inputs_table)
d <- as.data.frame(variables_list)
View(d)
reshape2::melt(data = variables_list)
tidyr::gather(variables_list, domain = 1)
tidyr::gather(variables_list)
reshape2::melt(data = variables_list)
reshape2::melt(data = variables_list, value = a)
reshape2::melt(data = variables_list, L1 = 3)
reshape2::melt(data = variables_list, value.name = "variable")
reshape2::melt(data = variables_list, value.name = "variable", varnames = c("domain"))
reshape2::melt(data = variables_list, value.name = "variable", varnames = c('domain'))
reshape2::melt(data = variables_list, value.name = "variable", varnames = 'domain')
reshape2::melt(data = variables_list, value.name = "variable", varname = 'domain')
reshape2::melt(data = variables_list, value.name = "variable", varnames = 'domain')
reshape2::melt(data = variables_list, value.name = "variable", varnames = c('domain'))
reshape2::melt(data = variables_list, value.name = "variable", varnames = c('domain', 'z'))
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
stringsAsFactors = FALSE)
dv_pairs <- reshape2::melt(data = variables_list, value.name = "variable")
View(target_inputs_table)
View(dv_pairs)
dv_pairs <- reshape2::melt(data = variables_list, value.name = "variable")
colnames(dv_pairs) <- c('variable', 'domain')
dv_pairs$domain <- str_replace(dv_pairs$domain, 'domain_', '')
View(dv_pairs)
inner_join(target_inputs_table, dv_pairs)
dv_pairs <- reshape2::melt.list(data = variables_list, value.name = "variable")
colnames(dv_pairs) <- c('variable', 'domain')
dv_pairs <- reshape2::melt(data = variables_list, value.name = "variable")
colnames(dv_pairs) <- c('variable', 'domain')
dv_pairs$domain <- str_replace(dv_pairs$domain, 'domain_', '')
inner_join(target_inputs_table, dv_pairs, by = "domain")
expand_grid_to_target_list <- function(model_list, domain_list, variables_list) {
target_inputs_table <- expand.grid(model = model_list,
domain = domain_list,
stringsAsFactors = FALSE)
# domain variable pairs
dv_pairs <- reshape2::melt(data = variables_list, value.name = "variable")
colnames(dv_pairs) <- c('variable', 'domain')
dv_pairs$domain <- str_replace(dv_pairs$domain, 'domain_', '')
inner_join(target_inputs_table, dv_pairs, by = "domain")
}
expand_grid_to_target_list <- function(model_list, domain_list, variables_list) {
# model / domain grid
md_grid <- expand.grid(model = model_list,
domain = domain_list,
stringsAsFactors = FALSE)
# domain variable pairs
dv_pairs <- reshape2::melt(data = variables_list, value.name = "variable")
colnames(dv_pairs) <- c('variable', 'domain')
dv_pairs$domain <- str_replace(dv_pairs$domain, 'domain_', '')
inner_join(md_grid, dv_pairs, by = "domain")
}
a <- expand_grid_to_target_list(model_list, domain_list, variables_list)
View(a)
View(a)
# calc GDD for BoM data
library(raster)
library(RmarineHeatWaves)
library(plyr)
library(dplyr)
library(sf)
library(stringr)
library(future)
library(zoo)
library(ggplot2)
ColourBlindFriendlyPalette <- c("#000000", "#999999", "#0072B2", "#56B4E9", "#009E73", "#F0E442", "#E69F00", "#D55E00", "#CC79A7")
